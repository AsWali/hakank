/*

  Test of bernoulli.

  See ~/blog/bernoulli_test.blog

*/

def main() {
  prob := beta(4,4);


  // R: rbinom(20,1,0.3);
  // ùîº[prob] = 9/28 (~0.32142857142857142857)
  y := [0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,1,1];

  // R: rbinom(40,1,0.8)
  // ùîº[prob] = 37/48 (~0.77083333333333333333)
  // y := [1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,0,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1];

  // R: rbinom(100,1,0.28)
  // ùîº[prob] = 29/108 (~0.26851851851851851852)
  // It took 5.744s
  // y := [0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,1,1,0,1,
  //       0,0,0,0,0,1,1,0,1,0,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
  //       0,1,1,0,0,0,0,1,0,0,1,0,1,0,0,0,1,1,0,1,0,0,0,0,0,0];

  // R: rbinom(200,1,0.32)
  // ùîº[prob] = 61/208 (~0.29326923076923076923)
  // 36.911s
  // y := [0,1,0,0,0,0,1,0,1,1,0,1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,
  //       0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,
  //       1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,1,1,0,0,1,1,1,0,0,1,1,0,0,0,1,0,
  //       1,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,1,0,1,0,1,0,0,
  //       1,0,1,0,0,0,0,1,0,1,0,1,1,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,1,
  //       0,0,0,0,0,0,0,1,0,1,0,0,0,0,0];

  len := y.length;

  // Random Integer y(Integer i) ~ Bernoulli(prob);
  for i in [0..len-1] {
    // y[i] = bernoulli(prob);
    observe(y[i] == bernoulli(prob));
  }

  return(prob);

}